# 三値分類予測 - *Recommender.py*
組成情報を用いて化合物の安定性を予測するプログラム

作成者：濱家雅人（名工大・中山研）

作成日：2023年6月7日


## 概要
無機固体材料の安定性を安定・準安定・不安定と仮定した際の分類予測スクリプト

下記のように分解エネルギーで安定性の分類を仮定した。

<img width="569" alt="image" src="https://github.com/NakayamaLab-NITech/Recommender/assets/102635361/42f11309-32a4-462e-9035-3af5e1389099">

*RandomForest* を用いた分類予測により、とても高精度な予測が可能となった。本スクリプトでは、学習済みモデルを読み込むことにより、新しく提示された化学組成の材料について安定性を出力している。スクリプト作動後、安定性予測結果と分類確率がファイル出力される。

## 詳細説明
本スクリプトの学習済みモデル作成には *MaterialsProject* から抽出された9.8万件のデータセットを用いた。

分解エネルギーは図(a)のような分布となり、拡大すると図(b)のように分布していることがわかる。各分類の分布割合は図(c)のようになる。

<img width="855" alt="image" src="https://github.com/NakayamaLab-NITech/Recommender/assets/102635361/f39dd687-5264-4697-9922-2fab82e1dc4b">

また、説明変数には中山研究室で開発されたヒストグラム記述子を用いています。詳しくは[中山研_ヒストグラム記述子][]

上述したデータセットを 80% の訓練データと 20% のテストデータに分割した。訓練データで学習し、テストデータで分類精度を評価した。また、訓練データの中で、k分割交差検証法を用いたハイパーパラメータチューニングを行っており、汎用性の高いパラメータ探索に尽力した。

4つの機械学習モデルを検証した中で、最も分類精度の高かった *RandomForest* を本スクリプトに掲載している。 *RandomForest* を用いた分類精度は **AUC = 0.88**, **正解率91%** を記録した。

下図は最も精度の良かった *RandomForest* の ROC曲線である。顕著に左上に近づくカーブを描いており、予測精度が良いことが読み取れる。

<img width="359" alt="画像11" src="https://github.com/NakayamaLab-NITech/Recommender/assets/102635361/863f64ff-1152-4f49-a16e-627011c23a01">








## 使用方法（Linux環境のみ対応しています）


## 結果の確認方法

